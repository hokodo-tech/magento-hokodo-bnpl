<?xml version="1.0"?>
<!--
/**
 * Copyright Â© 2018-2021 Hokodo. All Rights Reserved.
 * See LICENSE for license details.
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <preference for="Hokodo\BNPL\Api\Data\PaymentMethodInterface" type="Hokodo\BNPL\Model\Data\PaymentMethod" />
    <preference for="Hokodo\BNPL\Api\Data\CompanyInterface" type="Hokodo\BNPL\Model\Data\Company" />
    <preference for="Hokodo\BNPL\Api\Data\DeferredPaymentInterface" type="Hokodo\BNPL\Model\Data\DeferredPayment" />
    <preference for="Hokodo\BNPL\Api\Data\DeferredPaymentIpnInterface" type="Hokodo\BNPL\Model\Data\DeferredPaymentIpn" />
    <preference for="Hokodo\BNPL\Api\Data\DeferredPaymentIpnPayloadInterface" type="Hokodo\BNPL\Model\Data\DeferredPaymentIpnPayload" />
    <preference for="Hokodo\BNPL\Api\Data\FulfillmentInfoInterface" type="Hokodo\BNPL\Model\Data\FulfillmentInfo" />
    <preference for="Hokodo\BNPL\Api\Data\OrderDocumentsInterface" type="Hokodo\BNPL\Model\Data\OrderDocumentsInfo" />
    <preference for="Hokodo\BNPL\Api\Data\HokodoOrganisationInterface" type="Hokodo\BNPL\Model\HokodoOrganisation" />
    <preference for="Hokodo\BNPL\Api\Data\HokodoOrganisationSearchResultsInterface" type="Magento\Framework\Api\SearchResults" />
    <preference for="Hokodo\BNPL\Api\Data\OrderCustomerAddressInterface" type="Hokodo\BNPL\Model\Data\OrderCustomerAddress" />
    <preference for="Hokodo\BNPL\Api\Data\OrderCustomerInterface" type="Hokodo\BNPL\Model\Data\OrderCustomer" />
    <preference for="Hokodo\BNPL\Api\Data\OrderCustomerIpnInterface" type="Hokodo\BNPL\Model\Data\OrderCustomerIpn" />
    <preference for="Hokodo\BNPL\Api\Data\OrderInformationInterface" type="Hokodo\BNPL\Model\Data\OrderInformation" />
    <preference for="Hokodo\BNPL\Api\Data\OrderIpnInterface" type="Hokodo\BNPL\Model\Data\OrderIpn" />
    <preference for="Hokodo\BNPL\Api\Data\OrderItemInterface" type="Hokodo\BNPL\Model\Data\OrderItem" />
    <preference for="Hokodo\BNPL\Api\Data\OrganisationInterface" type="Hokodo\BNPL\Model\Data\Organisation" />
    <preference for="Hokodo\BNPL\Api\Data\OrganisationIpnInterface" type="Hokodo\BNPL\Model\Data\OrganisationIpn" />
    <preference for="Hokodo\BNPL\Api\Data\OrganisationUserInterface" type="Hokodo\BNPL\Model\Data\OrganisationUser" />
    <preference for="Hokodo\BNPL\Api\Data\PaymentOffersInterface" type="Hokodo\BNPL\Model\Data\PaymentOffers" />
    <preference for="Hokodo\BNPL\Api\Data\PaymentPlanInterface" type="Hokodo\BNPL\Model\Data\PaymentPlan" />
    <preference for="Hokodo\BNPL\Api\Data\PaymentQuoteInterface" type="Hokodo\BNPL\Model\PaymentQuote" />
    <preference for="Hokodo\BNPL\Api\Data\RejectionReasonInterface" type="Hokodo\BNPL\Model\Data\RejectionReason" />
    <preference for="Hokodo\BNPL\Api\Data\ScheduledPaymentsInterface" type="Hokodo\BNPL\Model\Data\ScheduledPayments" />
    <preference for="Hokodo\BNPL\Api\Data\UserInterface" type="Hokodo\BNPL\Model\Data\User" />
    <preference for="Hokodo\BNPL\Api\Data\UserOrganisationInterface" type="Hokodo\BNPL\Model\Data\UserOrganisation" />
    <preference for="Hokodo\BNPL\Api\Data\UserOrganisationResultInterface" type="Hokodo\BNPL\Model\Data\UserOrganisationResult" />
    <preference for="Hokodo\BNPL\Api\CompanySearchServiceInterface" type="Hokodo\BNPL\Model\CompanySearchService" />
    <preference for="Hokodo\BNPL\Api\DeferredPaymentIpnProcessorInterface" type="Hokodo\BNPL\Model\DeferredPaymentIpnProcessor" />
    <preference for="Hokodo\BNPL\Api\GuestOrderInformationManagementInterface" type="Hokodo\BNPL\Model\GuestOrderInformationManagement" />
    <preference for="Hokodo\BNPL\Api\GuestSetOrganisationServiceInterface" type="Hokodo\BNPL\Model\GuestSetOrganisationService" />
    <preference for="Hokodo\BNPL\Api\GuestSetUserServiceInterface" type="Hokodo\BNPL\Model\GuestSetUserService" />
    <preference for="Hokodo\BNPL\Api\HokodoOrganisationManagementInterface" type="Hokodo\BNPL\Model\HokodoOrganisationManagement" />
    <preference for="Hokodo\BNPL\Api\HokodoOrganisationCheckingInterface" type="Hokodo\BNPL\Model\HokodoOrganisationChecking" />
    <preference for="Hokodo\BNPL\Api\HokodoOrganisationRepositoryInterface" type="Hokodo\BNPL\Model\HokodoOrganisationRepository" />
    <preference for="Hokodo\BNPL\Api\OrderInformationManagementInterface" type="Hokodo\BNPL\Model\OrderInformationManagement" />
    <preference for="Hokodo\BNPL\Api\OrderDocumentsManagementInterface" type="Hokodo\BNPL\Model\OrderDocumentsManagement" />
    <preference for="Hokodo\BNPL\Api\PaymentQuoteRepositoryInterface" type="Hokodo\BNPL\Model\PaymentQuoteRepository" />
    <preference for="Hokodo\BNPL\Api\SetOrganisationServiceInterface" type="Hokodo\BNPL\Model\SetOrganisationService" />
    <preference for="Hokodo\BNPL\Api\SetUserServiceInterface" type="Hokodo\BNPL\Model\SetUserService" />
    <preference for="Hokodo\BNPL\Gateway\SubjectReaderInterface" type="Hokodo\BNPL\Gateway\SubjectReader" />

    <!-- Payment Method Facade configuration -->
    <virtualType name="HokodoBnplFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Hokodo\BNPL\Gateway\Config\Config::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Magento\Payment\Block\Form</argument>
            <argument name="infoBlockType" xsi:type="string">Hokodo\BNPL\Block\Info</argument>
            <argument name="valueHandlerPool" xsi:type="object">Hokodo\BNPL\Gateway\Config\ValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">Hokodo\BNPL\Gateway\Validator\ValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">Hokodo\BNPL\Gateway\Command\CommandPool</argument>
        </arguments>
    </virtualType>

    <!-- Value handlers infrastructure -->
    <virtualType name="Hokodo\BNPL\Gateway\Config\ValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">Hokodo\BNPL\Gateway\Config\ConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Config\ConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">Hokodo\BNPL\Gateway\Config\Config</argument>
        </arguments>
    </virtualType>

    <!-- Validators infrastructure -->
    <virtualType name="Hokodo\BNPL\Gateway\Validator\ValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">Hokodo\BNPL\Gateway\Validator\CountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Validator\CountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">Hokodo\BNPL\Gateway\Config\Config</argument>
        </arguments>
    </virtualType>
    <!-- END Validators infrastructure -->

    <!-- Commands infrastructure -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\CommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="company_search" xsi:type="string">Hokodo\BNPL\Gateway\Command\CompanySearch</item>
                <item name="company_view" xsi:type="string">Hokodo\BNPL\Gateway\Command\CompanyView</item>
                <item name="user_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\UserCreate</item>
                <item name="user_delete" xsi:type="string">Hokodo\BNPL\Gateway\Command\UserDelete</item>
                <item name="user_list" xsi:type="string">Hokodo\BNPL\Gateway\Command\UserList</item>
                <item name="organisation_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationCreate</item>
                <item name="organisation_delete" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationDelete</item>
                <item name="organisation_list" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationList</item>
                <item name="organisation_view" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationView</item>
                <item name="organisation_add_user" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationAddUser</item>
                <item name="organisation_remove_user" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationRemoveUser</item>
                <item name="order_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderCreate</item>
                <item name="order_update" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderUpdate</item>
                <item name="order_delete" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderDelete</item>
                <item name="order_list" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderList</item>
                <item name="order_view" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderView</item>
                <item name="order_fulfill" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderFulfill</item>
                <item name="order_cancel" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderCancel</item>
                <item name="order_return" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderReturn</item>
                <item name="order_discount" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderDiscount</item>
                <item name="payment_offers_delete" xsi:type="string">Hokodo\BNPL\Gateway\Command\PaymentOffersDelete</item>
                <item name="payment_offers_list" xsi:type="string">Hokodo\BNPL\Gateway\Command\PaymentOffersList</item>
                <item name="payment_offers_request_new" xsi:type="string">Hokodo\BNPL\Gateway\Command\PaymentOffersRequestNew</item>
                <item name="payment_offers_view" xsi:type="string">Hokodo\BNPL\Gateway\Command\PaymentOffersView</item>
                <item name="deferred_payment_view" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentView</item>
                <item name="deferred_payment_list" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentList</item>
                <item name="authorize" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentAuthorize</item>
                <item name="capture" xsi:type="string">Hokodo\BNPL\Gateway\Command\PostSale\CapturePayment</item>
                <item name="void" xsi:type="string">Hokodo\BNPL\Gateway\Command\PostSale\VoidPayment</item>
                <item name="cancel" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">Hokodo\BNPL\Gateway\Command\PostSale\RefundPayment</item>
                <item name="fetch_transaction_information" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentFetchStatus</item>
                <item name="create_order_documents" xsi:type="string">Hokodo\BNPL\Gateway\Command\CreateOrderDocuments</item>
                <item name="view_order_documents" xsi:type="string">Hokodo\BNPL\Gateway\Command\ViewOrderDocuments</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="transferFactory" xsi:type="object">Hokodo\BNPL\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Hokodo\BNPL\Gateway\Http\Client\GuzzleHttpClient</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\ResultInterfaceFactory</argument>
            <argument name="validator" xsi:type="object">Hokodo\BNPL\Gateway\Validator\ValidatorComposite</argument>
            <argument name="errorMessageMapper" xsi:type="object">Hokodo\BNPL\Gateway\ErrorMapper\VirtualErrorMessageMapper</argument>
        </arguments>
    </type>

    <type name="Hokodo\BNPL\Gateway\Http\Client\GuzzleHttpClient">
        <arguments>
            <argument name="converter" xsi:type="object">Hokodo\BNPL\Gateway\Http\Converter\JsonToArrayConverter</argument>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Logger</argument>
        </arguments>
    </type>

    <virtualType name="Hokodo\BNPL\Gateway\Command\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\Result</argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Validator\ValidatorComposite" type="Magento\Payment\Gateway\Validator\ValidatorComposite">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="responseCodeValidator" xsi:type="string">Hokodo\BNPL\Gateway\Validator\ResponseCodeValidator</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Hokodo error code mapper -->
    <virtualType name="Hokodo\BNPL\Gateway\ErrorMapper\VirtualConfigReader" type="Magento\Payment\Gateway\ErrorMapper\VirtualConfigReader">
        <arguments>
            <argument name="fileName" xsi:type="string">hokodo_error_mapping.xml</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\ErrorMapper\VirtualMappingData" type="Magento\Payment\Gateway\ErrorMapper\MappingData">
        <arguments>
            <argument name="reader" xsi:type="object">Hokodo\BNPL\Gateway\ErrorMapper\VirtualConfigReader</argument>
            <argument name="cacheId" xsi:type="string">hokodo_error_mapper</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\ErrorMapper\VirtualErrorMessageMapper" type="Magento\Payment\Gateway\ErrorMapper\ErrorMessageMapper">
        <arguments>
            <argument name="messageMapping" xsi:type="object">Hokodo\BNPL\Gateway\ErrorMapper\VirtualMappingData</argument>
        </arguments>
    </virtualType>

    <!-- Logger -->
    <virtualType name="Hokodo\BNPL\Model\Logger" type="Magento\Payment\Model\Method\Logger">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Logger\DefaultLogger</argument>
            <argument name="config" xsi:type="object">Hokodo\BNPL\Gateway\Config\Config</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Model\Logger\DefaultLogger" type="Magento\Framework\Logger\Monolog">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="debug" xsi:type="object">Hokodo\BNPL\Model\Logger\Handler\Debug</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Model\Logger\Handler\Debug" type="Magento\Framework\Logger\Handler\Base">
        <arguments>
            <argument name="fileName" xsi:type="string">/var/log/hokodo-bnpl.log</argument>
        </arguments>
    </virtualType>
    <!-- IPN Logger -->
    <type name="Hokodo\BNPL\Controller\OnAuthorization\Index">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Controller\OnAuthorization\Success">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Model\PostSaleProcessor">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Model\DeferredPaymentIpnProcessor">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger</argument>
        </arguments>
    </type>
    <virtualType name="Hokodo\BNPL\Model\Ipn\Logger" type="Magento\Payment\Model\Method\Logger">
        <arguments>
            <argument name="logger" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger\DefaultLogger</argument>
            <argument name="config" xsi:type="object">Hokodo\BNPL\Gateway\Config\Config</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Model\Ipn\Logger\DefaultLogger" type="Magento\Framework\Logger\Monolog">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="debug" xsi:type="object">Hokodo\BNPL\Model\Ipn\Logger\Handler\Debug</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Model\Ipn\Logger\Handler\Debug" type="Magento\Framework\Logger\Handler\Base">
        <arguments>
            <argument name="fileName" xsi:type="string">/var/log/hokodo-deferred-payment-ipn.log</argument>
        </arguments>
    </virtualType>
    <!-- End Logger -->

    <!-- Methods builders -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\GetMethodBuilder" type="Hokodo\BNPL\Gateway\Request\MethodBuilder">
        <arguments>
            <argument name="method" xsi:type="string">GET</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostMethodBuilder" type="Hokodo\BNPL\Gateway\Request\MethodBuilder">
        <arguments>
            <argument name="method" xsi:type="string">POST</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PutMethodBuilder" type="Hokodo\BNPL\Gateway\Request\MethodBuilder">
        <arguments>
            <argument name="method" xsi:type="string">PUT</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PatchMethodBuilder" type="Hokodo\BNPL\Gateway\Request\MethodBuilder">
        <arguments>
            <argument name="method" xsi:type="string">PATCH</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder" type="Hokodo\BNPL\Gateway\Request\MethodBuilder">
        <arguments>
            <argument name="method" xsi:type="string">DELETE</argument>
        </arguments>
    </virtualType>
    <!-- End Methods builders -->

    <!-- Endpoints builders -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanyViewEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\CompanySubjectReader</argument>
            <argument name="endpoint" xsi:type="string">companies/:company_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":company_id" xsi:type="string">id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanySearchEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">companies/search</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\UserSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">users</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserViewEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\UserEndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">users/:user_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":user_id" xsi:type="string">id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\OrganisationSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">organisations</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationViewEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\OrganisationEndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">organisations/:organisation_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":organisation_id" xsi:type="string">id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserOrganisationEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\UserOrganisationSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">organisations/:organisation_id/users</argument>
            <argument name="params" xsi:type="array">
                <item name=":organisation_id" xsi:type="string">organisation_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserOrganizationUserEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\UserOrganisationEndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">organisations/:organisation_id/users/:user_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":user_id" xsi:type="string">user_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\OrderSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/orders</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderUpdaterEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\OrderSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_api_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":order_api_id" xsi:type="string">order_api_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderViewEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\OrderEndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":order_id" xsi:type="string">order_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOfferEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\PaymentOfferSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/offers</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOfferViewEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\PaymentOfferSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/offers/:offer_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":offer_id" xsi:type="string">offer_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentEndpoint" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\DeferredPaymentSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/deferred_payments</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentViewEndpoint" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\DeferredPaymentSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/deferred_payments/:deferredpayment_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":deferredpayment_id" xsi:type="string">deferred_payment_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorizeEndpoint" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\DeferredPaymentOrderSubjectReader</argument>
            <argument name="endpoint" xsi:type="string">payment/deferred_payments/:deferredpayment_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":deferredpayment_id" xsi:type="string">hokodo_deferred_payment_id</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\OrderSubjectReader</argument>
            <argument name="params" xsi:type="array">
                <item name=":order_id" xsi:type="string">order_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderFulfillEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/fulfill</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderAmendEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/amend</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderCancelEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/cancel</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderReturnEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/return</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderDiscountEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/discount</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleOrderMarkDisputedEndpoint" type="Hokodo\BNPL\Gateway\Request\PostSaleOrderEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/mark_disputed</argument>
        </arguments>
    </virtualType>

    <!-- Create Order documents Endpoint -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderDocumentsEndpoint" type="Hokodo\BNPL\Gateway\Request\EndpointBuilder">
        <arguments>
            <argument name="subjectReader" xsi:type="object">Hokodo\BNPL\Gateway\OrderDocumentsSubjectReader</argument>
            <argument name="params" xsi:type="array">
                <item name=":order_id" xsi:type="string">order_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\CreateOrderDocumentsEndpoint" type="Hokodo\BNPL\Gateway\Request\OrderDocumentsEndpoint">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/documents</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\ViewOrderDocumentsEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\OrderEndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:order_id/documents/:document_id</argument>
            <argument name="params" xsi:type="array">
                <item name=":order_id" xsi:type="string">order_id</item>
                <item name=":document_id" xsi:type="string">document_id</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- End Endpoints builders -->

    <!-- Company command -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\CompanySearch" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\CompanySearch\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Company\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\CompanyView" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\CompanyView\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Company\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>

    <!-- Company Search Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\Company\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\Company</argument>
        </arguments>
    </virtualType>

    <!-- Company Search Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanySearch\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\CompanySearchEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="company_name" xsi:type="string">Hokodo\BNPL\Gateway\Request\CompanySearch\CompanyNameBuilder</item>
                <item name="company_country" xsi:type="string">Hokodo\BNPL\Gateway\Request\CompanySearch\CompanyCountryBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanySearch\CompanyNameBuilder" type="Hokodo\BNPL\Gateway\Request\FieldValueBuilder">
        <arguments>
            <argument name="field" xsi:type="string">name</argument>
            <argument name="value" xsi:type="string">name</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanySearch\CompanyCountryBuilder" type="Hokodo\BNPL\Gateway\Request\FieldValueBuilder">
        <arguments>
            <argument name="field" xsi:type="string">country</argument>
            <argument name="value" xsi:type="string">country</argument>
        </arguments>
    </virtualType>

    <!-- Company View Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\CompanyView\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\CompanyViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>


    <!-- End Company Search command -->

    <!-- Customer command -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\UserCreate" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\UserCreate\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\User\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\UserList" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\UserList\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\User\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\UserDelete" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\UserDelete\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\User\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>

    <!-- User Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\User\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\User</argument>
        </arguments>
    </virtualType>

    <!-- Customer Create Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserCreate\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="user_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Customer List Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserList\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Customer Delete Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserDelete\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- End Customer command -->

    <!-- Organisation command -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationCreate" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationCreate\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationView" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationView\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationList" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationList\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationDelete" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationDelete\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationAddUser" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationAddUser\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\UserOrganisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationRemoveUser" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationRemoveUser\BuilderComposite</argument>
        </arguments>
    </virtualType>

    <!-- Organisation Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\Organisation</argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Command\UserOrganisation\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\UserOrganisation</argument>
        </arguments>
    </virtualType>

    <!-- Create Organization Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationCreate\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrganisationEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="organisation_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrganisationBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Organisation View  Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationView\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrganisationViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Organization List Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationList\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrganisationEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Delete Organization Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationDelete\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrganisationViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Add User Organization Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationAddUser\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserOrganisationEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserOrganisationBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Remove User Organization Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationRemoveUser\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\UserOrganizationUserEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>


    <!-- Payment Orders commands -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderCreate" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderCreate\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderUpdate" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderUpdate\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderView" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderView\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderFulfill" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderFulfill\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderCancel" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderCancel\BuilderComposite</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderReturn" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderReturn\BuilderComposite</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderDiscount" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderDiscount\BuilderComposite</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderList" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderList\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderDelete" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderDelete\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>

    <!-- Order Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\Order</argument>
        </arguments>
    </virtualType>

    <!-- Create order documents result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\CreateOrderDocuments" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\CreateOrderDocuments\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\ViewOrderDocuments" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\ViewOrderDocuments\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>

    <!-- Create Order Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderCreate\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderUpdate\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderUpdaterEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PatchMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderUpdater</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Order View Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderView\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\OrderAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Fulfill Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderFulfill\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\OrderAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostSaleOrderFulfillEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PutMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderItemsBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Cancel Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderCancel\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostSaleOrderCancelEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PutMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\AllOrderItemsBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Refund Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderReturn\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\OrderAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostSaleOrderReturnEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PutMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\AllOrderItemsBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Discount Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderDiscount\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostSaleOrderDiscountEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PutMethodBuilder</item>
                <item name="order_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\AllOrderItemsBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order List Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderList\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Delete Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderDelete\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\OrderAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\OrderViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Payment Offers commands -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\PaymentOffersRequestNew" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\PaymentOffersRequestNew\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\PaymentOffersView" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\PaymentOffersView\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\PaymentOffersList" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\PaymentOffersList\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\PaymentOffersDelete" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\PaymentOffersDelete\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>

    <!-- Create Order Documents Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\CreateOrderDocuments\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\DocumentAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\CreateOrderDocumentsEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="documents_body" xsi:type="string">Hokodo\BNPL\Gateway\Request\CreateOrderDocumentsBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- View order document request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\ViewOrderDocuments\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\ViewOrderDocumentsEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Payment Offers Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\PaymentOffer</argument>
        </arguments>
    </virtualType>

    <!-- Request a new offer Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOffersRequestNew\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PaymentOfferEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\RequestNewOfferBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Request a view offer Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOffersView\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PaymentOfferViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Request a list offer Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOffersList\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PaymentOfferEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Request a delete  offer Request -->
    <virtualType name="Hokodo\BNPL\Gateway\Request\PaymentOffersDelete\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\PaymentOfferViewEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeleteMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order Deferred Payment command -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentAuthorize" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorize\BuilderComposite</argument>
            <argument name="handler" xsi:type="object">Hokodo\BNPL\Gateway\Response\DeferredPaymentOrderHandler</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentCapture" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorize\BuilderComposite</argument>
            <argument name="handler" xsi:type="object">Hokodo\BNPL\Gateway\Response\DeferredPaymentCaptureHandler</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentFetchStatus" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorize\BuilderComposite</argument>
            <argument name="handler" xsi:type="object">Hokodo\BNPL\Gateway\Response\DeferredPaymentFetchStatusHandler</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentView" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentView\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\DeferredPayment\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentList" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentList\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\DeferredPayment\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorize\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\Authorization\DeferredPaymentAuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeferredPaymentAuthorizeEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentView\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeferredPaymentViewEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentList\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeferredPaymentEndpoint</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Deferred Payment Result -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPayment\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\DeferredPayment</argument>
        </arguments>
    </virtualType>

    <type name="Hokodo\BNPL\Service\AbstractService">
        <arguments>
            <argument name="commandPool" xsi:type="object">Hokodo\BNPL\Gateway\Command\CommandPool</argument>
        </arguments>
    </type>


    <type name="Hokodo\BNPL\Block\Info">
        <arguments>
            <argument name="config" xsi:type="object">Hokodo\BNPL\Gateway\Config\Config</argument>
        </arguments>
    </type>

    <type name="Magento\Customer\Model\Metadata\CustomerMetadata">
        <arguments>
            <argument name="systemAttributes" xsi:type="array">
                <item name="hokodo_user_id" xsi:type="string">hokodo_user_id</item>
                <item name="hokodo_organization_id" xsi:type="string">hokodo_organization_id</item>
            </argument>
        </arguments>
    </type>

    <type name="Magento\Sales\Model\ResourceModel\Order\Shipment">
        <plugin name="hokodo_sales_resource_shipment" type="Hokodo\BNPL\Plugin\Model\Sales\ResourceModel\Order\Shipment"/>
    </type>

    <type name="Magento\Sales\Model\ResourceModel\Order\Invoice">
        <plugin name="hokodo_sales_resource_invoice" type="Hokodo\BNPL\Plugin\Model\Sales\ResourceModel\Order\Invoice"/>
    </type>

    <type name="Magento\Sales\Model\ResourceModel\Order\Creditmemo">
        <plugin name="hokodo_sales_resource_creditmemo" type="Hokodo\BNPL\Plugin\Model\Sales\ResourceModel\Order\Creditmemo"/>
    </type>

    <type name="Magento\Sales\Model\ResourceModel\Order">
        <plugin name="hokodo_sales_order" type="Hokodo\BNPL\Plugin\OrderSaveCreateInvoicePlugin"/>
    </type>

    <type name="Hokodo\BNPL\Service\LoggerService">
        <arguments>
            <argument name="name" xsi:type="string">hokodoLogger</argument>
            <argument name="handlers"  xsi:type="array">
                <item name="system" xsi:type="object">Hokodo\BNPL\Service\LoggerHandler</item>
            </argument>
        </arguments>
    </type>

    <!-- Payment Logs -->
    <preference for="Hokodo\BNPL\Api\Data\PaymentLogSearchResultsInterface" type="Magento\Framework\Api\SearchResults" />
    <preference for="Hokodo\BNPL\Api\PaymentLogRepositoryInterface" type="Hokodo\BNPL\Model\PaymentLogRepository" />
    <preference for="Hokodo\BNPL\Api\Data\PaymentLogInterface" type="Hokodo\BNPL\Model\PaymentLog" />

    <type name="Hokodo\BNPL\Model\PaymentLogRepository">
        <arguments>
            <argument name="collectionProcessor" xsi:type="object">Hokodo\BNPL\Model\Api\SearchCriteria\PaymentLogCollectionProcessor</argument>
        </arguments>
    </type>
    <virtualType name="Hokodo\BNPL\Model\Api\SearchCriteria\CollectionProcessor\PaymentLogFilterProcessor" type="Magento\Framework\Api\SearchCriteria\CollectionProcessor\FilterProcessor">
        <arguments>
            <argument name="fieldMapping" xsi:type="array">
                <item name="payment_log_id" xsi:type="string">payment_log_id</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Model\Api\SearchCriteria\PaymentLogCollectionProcessor" type="Magento\Framework\Api\SearchCriteria\CollectionProcessor">
        <arguments>
            <argument name="processors" xsi:type="array">
                <item name="filters" xsi:type="object">Hokodo\BNPL\Model\Api\SearchCriteria\CollectionProcessor\PaymentLogFilterProcessor</item>
            </argument>
        </arguments>
    </virtualType>

    <type name="Magento\Framework\View\Element\UiComponent\DataProvider\CollectionFactory">
        <arguments>
            <argument name="collections" xsi:type="array">
                <item name="hokodo_bnpl_log_listing_data_source" xsi:type="string">Hokodo\BNPL\Model\ResourceModel\PaymentLog\Grid\Collection</item>
            </argument>
        </arguments>
    </type>
    <virtualType name="Hokodo\BNPL\Model\ResourceModel\PaymentLog\Grid\Collection" type="Magento\Framework\View\Element\UiComponent\DataProvider\SearchResult">
        <arguments>
            <argument name="mainTable" xsi:type="string">hokodo_payment_logs</argument>
            <argument name="resourceModel" xsi:type="string">Hokodo\BNPL\Model\ResourceModel\PaymentLog</argument>
        </arguments>
    </virtualType>

    <!-- Reduce PDF file size -->
    <preference for="Magento\Sales\Model\Order\Pdf\Invoice" type="Hokodo\BNPL\Model\Pdf\Invoice" />
    <preference for="Magento\Sales\Model\Order\Pdf\Shipment" type="Hokodo\BNPL\Model\Pdf\Shipment" />


    <!-- SDK UPGRADE -->

    <preference for="Hokodo\BNPL\Api\Data\HokodoQuoteInterface" type="Hokodo\BNPL\Model\HokodoQuote" />
    <preference for="Hokodo\BNPL\Api\HokodoQuoteRepositoryInterface" type="Hokodo\BNPL\Model\HokodoQuoteRepository" />
    <preference for="Hokodo\BNPL\Api\Data\HokodoCustomerInterface" type="Hokodo\BNPL\Model\Data\HokodoCustomer" />
    <preference for="Hokodo\BNPL\Api\HokodoCustomerRepositoryInterface" type="Hokodo\BNPL\Model\HokodoCustomerRepository" />
    <type name="Hokodo\BNPL\Gateway\Service\AbstractService">
        <arguments>
            <argument name="commandPool" xsi:type="object">Hokodo\BNPL\Gateway\Command\CommandPool</argument>
        </arguments>
    </type>
    <type name="Magento\Checkout\Model\ShippingInformationManagement">
        <plugin name="after_shipping_address_saved" type="Hokodo\BNPL\Plugin\Model\Checkout\ShippingInformation" sortOrder="10"/>
    </type>
    <type name="Hokodo\BNPL\Plugin\Model\Checkout\ShippingInformation">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>
    <type name="Magento\Quote\Model\CouponManagement">
        <plugin name="hokodo_coupon" type="Hokodo\BNPL\Plugin\Quote\Model\CouponManagement"/>
    </type>
    <type name="Hokodo\BNPL\Plugin\Quote\Model\CouponManagement">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Model\Webapi\User">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Model\Webapi\Organisation">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>
    <type name="Hokodo\BNPL\Model\Webapi\Offer">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>

    <!-- js SDK API backend-frontend communication config -->
    <preference for="Hokodo\BNPL\Api\Webapi\OrganisationInterface" type="Hokodo\BNPL\Model\Webapi\Organisation" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\CreateOrganisationRequestInterface" type="Hokodo\BNPL\Model\Data\Webapi\CreateOrganisationRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\CreateOrganisationResponseInterface" type="Hokodo\BNPL\Model\Data\Webapi\CreateOrganisationResponse" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\CreateOrganisationRequestInterface" type="Hokodo\BNPL\Model\Data\Gateway\CreateOrganisationRequest" />

    <preference for="Hokodo\BNPL\Api\Webapi\UserInterface" type="Hokodo\BNPL\Model\Webapi\User" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\UserOrganisationInterface" type="Hokodo\BNPL\Model\Data\Gateway\UserOrganisation" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\CreateUserRequestInterface" type="Hokodo\BNPL\Model\Data\Webapi\CreateUserRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\CreateUserResponseInterface" type="Hokodo\BNPL\Model\Data\Webapi\CreateUserResponse" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\CreateUserRequestInterface" type="Hokodo\BNPL\Model\Data\Gateway\CreateUserRequest" />

    <preference for="Hokodo\BNPL\Api\Webapi\OfferInterface" type="Hokodo\BNPL\Model\Webapi\Offer" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\OfferRequestInterface" type="Hokodo\BNPL\Model\Data\Webapi\OfferRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\OfferResponseInterface" type="Hokodo\BNPL\Model\Data\Webapi\OfferResponse" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\CreateOrderRequestInterface" type="\Hokodo\BNPL\Model\Data\Gateway\CreateOrderRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\PatchOrderRequestInterface" type="\Hokodo\BNPL\Model\Data\Gateway\PatchOrderRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\OrderCustomerInterface" type="Hokodo\BNPL\Model\Data\Gateway\OrderCustomer" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\CustomerAddressInterface" type="Hokodo\BNPL\Model\Data\Gateway\CustomerAddress" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\OrderItemInterface" type="Hokodo\BNPL\Model\Data\Gateway\OrderItem" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\CreateOfferRequestInterface" type="Hokodo\BNPL\Model\Data\Gateway\CreateOfferRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Gateway\OfferUrlsInterface" type="Hokodo\BNPL\Model\Data\Gateway\OfferUrls" />

    <preference for="Hokodo\BNPL\Api\Webapi\HokodoCustomerInterface" type="Hokodo\BNPL\Model\Webapi\HokodoCustomer"/>
    <preference for="Hokodo\BNPL\Api\Data\Webapi\HokodoCustomerRequestInterface" type="Hokodo\BNPL\Model\Data\Webapi\HokodoCustomerRequest" />
    <preference for="Hokodo\BNPL\Api\Data\Webapi\HokodoCustomerResponseInterface" type="Hokodo\BNPL\Model\Data\Webapi\HokodoCustomerResponse" />

    <!-- Commands infrastructure -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\CommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="sdk_organisation_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrganisationCreateSdk</item>
                <item name="sdk_user_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\UserCreateSdk</item>
                <item name="sdk_order_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderCreateSdk</item>
                <item name="sdk_order_get" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderGetSdk</item>
                <item name="sdk_order_patch" xsi:type="string">Hokodo\BNPL\Gateway\Command\OrderPatchSdk</item>
                <item name="sdk_offer_create" xsi:type="string">Hokodo\BNPL\Gateway\Command\OfferCreateSdk</item>
                <item name="sdk_offer_get" xsi:type="string">Hokodo\BNPL\Gateway\Command\OfferGetSdk</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Organisation create gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrganisationCreateSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrganisationCreateSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Organisation\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrganisationCreateSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OrganisationEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OrganisationEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">organisations</argument>
        </arguments>
    </virtualType>

    <!-- User create gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\UserCreateSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\UserCreateSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\User\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\UserCreateSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\UserEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\UserEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">users</argument>
        </arguments>
    </virtualType>

    <!-- Order create gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderCreateSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderCreateSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderCreateSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OrderEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OrderEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders</argument>
        </arguments>
    </virtualType>

    <!-- Order get gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderGetSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderGetSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderGetSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OrderGetEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OrderGetEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:id</argument>
            <argument name="params" xsi:type="array">
                <item name=":id" xsi:type="string">id</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Order patch gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OrderPatchSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OrderPatchSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\Order\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OrderPatchSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OrderPatchEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PatchMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OrderPatchEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/orders/:id</argument>
            <argument name="params" xsi:type="array">
                <item name=":id" xsi:type="string">order_id</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Offer create gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OfferCreateSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OfferCreateSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OfferCreateSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OfferEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OfferEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/offers</argument>
        </arguments>
    </virtualType>

    <!-- Offer get gateway set up -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\OfferGetSdk" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\OfferGetSdk\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\PaymentOffer\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\OfferGetSdk\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\OfferGetEndpointBuilder</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\GetMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\Sdk\OfferGetEndpointBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/offers/:id</argument>
            <argument name="params" xsi:type="array">
                <item name=":id" xsi:type="string">id</item>
            </argument>
        </arguments>
    </virtualType>
    <type name="Magento\CheckoutAgreements\Model\AgreementsProvider">
        <plugin name="hokodo_checkout_agreements_agreements_provider"
                type="Hokodo\BNPL\Plugin\Model\CheckoutAgreements\AgreementsProvider"
                sortOrder="1" disabled="false"/>
    </type>
    <type name="Hokodo\BNPL\Plugin\Model\CheckoutAgreements\AgreementsProvider">
        <arguments>
            <argument name="checkoutSession" xsi:type="object">Magento\Checkout\Model\Session\Proxy</argument>
        </arguments>
    </type>


    <!-- Post Sale Actions v2 -->
    <preference for="\Hokodo\BNPL\Api\Data\Gateway\DeferredPaymentsPostSaleActionInterface" type="\Hokodo\BNPL\Model\Data\Gateway\DeferredPaymentsPostSaleAction" />
    <preference for="\Hokodo\BNPL\Api\Data\PostSaleEventInterface" type="\Hokodo\BNPL\Model\Data\PostSaleEvent" />
    <preference for="\Hokodo\BNPL\Api\Data\PostSaleEventChangesInterface" type="\Hokodo\BNPL\Model\Data\PostSaleEventChanges" />

    <!-- Commands infrastructure -->
    <virtualType name="Hokodo\BNPL\Gateway\Command\CommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="hokodo_post_sale" xsi:type="string">Hokodo\BNPL\Gateway\Command\DeferredPaymentsPostSale</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentsPostSale" type="Hokodo\BNPL\Gateway\Command\HokodoGatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentsPostSale\BuilderComposite</argument>
            <argument name="resultFactory" xsi:type="object">Hokodo\BNPL\Gateway\Command\DeferredPaymentsPostSale\ResultInterfaceFactory</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentsPostSale\BuilderComposite" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="api_key" xsi:type="string">Hokodo\BNPL\Gateway\Request\AuthorizationBuilder</item>
                <item name="uri" xsi:type="string">Hokodo\BNPL\Gateway\Request\DeferredPaymentsPostSale</item>
                <item name="method" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostMethodBuilder</item>
                <item name="body" xsi:type="string">Hokodo\BNPL\Gateway\Request\PostSaleEventBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\DeferredPaymentsPostSale" type="Hokodo\BNPL\Gateway\Request\Sdk\EndpointBuilder">
        <arguments>
            <argument name="endpoint" xsi:type="string">payment/deferred_payments/:payment_id/:type</argument>
            <argument name="params" xsi:type="array">
                <item name=":payment_id" xsi:type="string">payment_id</item>
                <item name=":type" xsi:type="string">type</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Request\PostSaleEventBuilder" type="Hokodo\BNPL\Gateway\Request\Sdk\GeneralSubjectBuilder">
        <arguments>
            <argument name="endpointBuilder" xsi:type="object">Hokodo\BNPL\Gateway\Request\DeferredPaymentsPostSale</argument>
        </arguments>
    </virtualType>
    <virtualType name="Hokodo\BNPL\Gateway\Command\DeferredPaymentsPostSale\ResultInterfaceFactory" type="Magento\Payment\Gateway\Command\ResultInterfaceFactory">
        <arguments>
            <argument name="instanceName" xsi:type="string">Hokodo\BNPL\Gateway\Command\Result\PostSaleEvent</argument>
        </arguments>
    </virtualType>
</config>
